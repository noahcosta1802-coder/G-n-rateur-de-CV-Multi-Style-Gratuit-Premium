<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>G√©n√©rateur de CV Multi-Style</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">
<style>
:root{
  --primary-color:#2563eb;
  --font-family:'Inter', sans-serif;
  --bg:#f5f7fb;
}
body{margin:0; font-family:var(--font-family); background:var(--bg); color:#111827;}
.wrap{display:grid; grid-template-columns:420px 1fr; gap:20px; max-width:1200px; margin:0 auto; padding:20px;}
@media(max-width:980px){.wrap{grid-template-columns:1fr}}
.panel{background:white; padding:18px; border-radius:10px; box-shadow:0 6px 18px rgba(16,24,40,0.06); height:calc(100vh - 80px); overflow:auto;}
input,textarea,select{width:100%; padding:8px 10px; margin-top:6px; border-radius:6px; border:1px solid #e6e9ef; background:#fbfcff; font-size:14px;}
textarea{resize:vertical; min-height:70px;}
label{margin-top:12px; display:block; font-size:13px; color:#6b7280;}
.btn{padding:8px 12px; border:none; border-radius:8px; background:#2563eb; color:white; cursor:pointer; margin-top:12px; text-align:center; display:inline-block;}
.btn.secondary{background:#111827; opacity:0.08; color:#6b7280;}
.template-selector{display:flex; flex-wrap:wrap; gap:6px; margin-top:6px;}
.template-btn{padding:6px 10px; border:1px solid #e6e9ef; border-radius:6px; cursor:pointer; font-size:13px;}
.template-btn.active{border-color:var(--primary-color); box-shadow:0 4px 12px rgba(37,99,235,0.12);}
.paper-wrap{flex:1; overflow:auto; padding:0 0 40px 0;}
.paper{background:white; border-radius:8px; padding:28px; box-shadow:0 6px 18px rgba(2,6,23,0.06); width:100%; max-width:800px; margin:0 auto;}
.name{font-size:28px; font-weight:700; color:#111827;}
.subtitle{color:#6b7280; margin-top:4px;}
.section-title{font-weight:700; margin-top:14px; font-size:13px; color:#0f172a;}
.muted{color:#6b7280; font-size:13px;}
.photo{width:96px; height:96px; border-radius:12px; object-fit:cover; border:2px solid #efefef;}
.skill-pill{display:inline-block; background:#f1f5f9; padding:6px 10px; border-radius:999px; margin:4px 4px 0 0; font-size:13px;}
.premium-lock{color:#dc2626; font-size:12px; font-weight:600; margin-left:6px;}
.slogan{font-size:16px; font-weight:600; color:#111827; margin-bottom:12px;}
</style>
</head>
<body>
<div class="wrap">

  <!-- FORM PANEL -->
  <aside class="panel">
    <h1>G√©n√©rateur de CV Multi-Style</h1>
    <div class="slogan">Votre CV parfait, en quelques clics !</div>

    <label>Mod√®les disponibles</label>
    <div class="template-selector" id="template-selector"></div>

    <label>Nom complet</label><input id="input-name" type="text" value="Jean Dupont">
    <label>Titre / Poste</label><input id="input-title" type="text" value="Assistant administratif">
    <label>R√©sum√©</label><textarea id="input-summary">Employ√© de commerce motiv√©, go√ªt pour la finance et l'organisation.</textarea>
    <label>Email</label><input id="input-email" type="email" value="jean.dupont@example.com">
    <label>T√©l√©phone</label><input id="input-phone" type="tel" value="+41 79 000 00 00">
    <label>Adresse</label><input id="input-address" type="text" value="Lausanne, VD">
    <label>Photo (URL)</label><input id="input-photo" type="text" value="https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=800&q=80">
    <label>Comp√©tences (s√©par√©es par virgule)</label><input id="input-skills" value="Excel, Organisation, Service client">
    <label>Langues (s√©par√©es par virgule)</label><input id="input-langs" value="Fran√ßais, Anglais">

    <div class="actions">
      <button id="preview-btn" class="btn">Aper√ßu</button>
      <button id="download-btn" class="btn">T√©l√©charger PDF</button>
    </div>

    <div style="margin-top:20px; padding-top:10px; border-top:1px solid #e6e9ef;">
      <h2>Abonnement Premium</h2>
      <p>D√©bloquez tous les mod√®les (100+) et fonctionnalit√©s avanc√©es pour seulement CHF 2/mois !</p>
      <!-- Bouton PayPal Subscription -->
      <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
        <input type="hidden" name="cmd" value="_xclick-subscriptions">
        <input type="hidden" name="business" value="TON_EMAIL_PAYPAL@EXEMPLE.COM">
        <input type="hidden" name="item_name" value="CV Generator Premium">
        <input type="hidden" name="currency_code" value="CHF">
        <input type="hidden" name="a3" value="2.00"> <!-- Prix par mois -->
        <input type="hidden" name="p3" value="1">
        <input type="hidden" name="t3" value="M"> <!-- Mensuel -->
        <input type="hidden" name="src" value="1"> <!-- Paiement r√©current -->
        <input type="hidden" name="sra" value="1"> <!-- Reattempt on failure -->
        <button type="submit" class="btn">S'abonner Premium</button>
      </form>
    </div>
  </aside>

  <!-- PREVIEW PANEL -->
  <section class="paper-wrap">
    <div id="cv-container" class="paper"></div>
  </section>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
<script>
/* ====== MODELS JSON ====== */
let templates = [];

// 5 mod√®les gratuits
for(let i=1;i<=5;i++){
  templates.push({id:'free'+i, name:'Mod√®le '+i, primary:'#'+(Math.floor(Math.random()*16777215).toString(16)), font:i%2===0?'Inter':'Merriweather', premium:false});
}
// 100 mod√®les Premium
for(let i=1;i<=100;i++){
  templates.push({id:'premium'+i, name:'Premium '+i, primary:'#'+(Math.floor(Math.random()*16777215).toString(16)), font:i%2===0?'Inter':'Merriweather', premium:true});
}

/* STATE */
let state = {tpl:'free1', name:'Jean Dupont', title:'Assistant administratif', summary:'Employ√© de commerce motiv√©, go√ªt pour la finance et l\'organisation.',
  email:'jean.dupont@example.com', phone:'+41 79 000 00 00', address:'Lausanne, VD',
  photo:'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=800&q=80',
  skills:['Excel','Organisation','Service client'], langs:['Fran√ßais','Anglais']};

/* Template buttons */
const selectorDiv = document.getElementById('template-selector');
function generateTemplateButtons(){
  selectorDiv.innerHTML='';
  templates.forEach(t=>{
    const btn=document.createElement('button');
    btn.className='template-btn'+(t.id===state.tpl?' active':'');
    btn.innerText=t.name+(t.premium?' üîí':'');
    btn.onclick=()=>{
      if(t.premium){ alert("Abonnement Premium requis pour ce mod√®le."); return; }
      state.tpl=t.id;
      renderPreview();
      updateActiveButton();
    };
    selectorDiv.appendChild(btn);
  });
}
function updateActiveButton(){
  document.querySelectorAll('.template-btn').forEach(btn=>btn.classList.remove('active'));
  document.querySelectorAll('.template-btn').forEach(btn=>{
    if(btn.innerText.includes(state.tpl)) btn.classList.add('active');
  });
}

/* Inputs */
['name','title','summary','email','phone','address','photo','skills','langs'].forEach(key=>{
  const el=document.getElementById('input-'+key);
  el.addEventListener('input',()=>{
    if(key==='skills'||key==='langs'){state[key]=el.value.split(',').map(s=>s.trim()).filter(Boolean);}
    else state[key]=el.value;
    renderPreview();
  });
});

/* Render CV */
function renderPreview(){
  const c=state;
  const tpl=templates.find(t=>t.id===state.tpl);
  document.documentElement.style.setProperty('--primary-color', tpl.primary);
  document.documentElement.style.setProperty('--font-family', tpl.font);

  const skillsHTML=c.skills.map(s=>`<span class="skill-pill">${s}</span>`).join(' ');
  const langsHTML=c.langs.join(', ');

  const html=`<div style="font-family:${tpl.font}; color:${tpl.primary}">
    <div style="display:flex; gap:18px;">
      <img src="${c.photo}" class="photo" alt="Photo">
      <div>
        <div class="name">${c.name}</div>
        <div class="subtitle">${c.title}</div>
        <div class="section-title">R√©sum√©</div><div class="muted">${c.summary}</div>
        <div class="section-title">Contact</div>
        <div class="muted">${c.email}<br>${c.phone}<br>${c.address}</div>
        <div class="section-title">Comp√©tences</div><div>${skillsHTML}</div>
        <div class="section-title">Langues</div><div class="muted">${langsHTML}</div>
      </div>
    </div>
  </div>`;
  document.getElementById('cv-container').innerHTML=html;
}

/* Download PDF */
document.getElementById('download-btn').addEventListener('click',()=>{
  const opt={margin:10, filename:state.name+'_CV.pdf', image:{type:'jpeg',quality:0.98}, html2canvas:{scale:2}, jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}};
  html2pdf().set(opt).from(document.getElementById('cv-container')).save();
});

/* Initial render */
generateTemplateButtons();
renderPreview();
</script>
</body>
</html>
